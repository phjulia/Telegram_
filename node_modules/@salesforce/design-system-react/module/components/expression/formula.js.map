{"version":3,"sources":["../../../.tmp-es/components/expression/formula.jsx"],"names":["React","PropTypes","classNames","assign","ContentEditable","shortid","EXPRESSION_FORMULA","Button","propTypes","assistiveText","shape","help","string","id","className","oneOfType","array","object","events","onChangeTextEditor","func","onClickHelp","onClickCheckSyntax","labels","label","checkSyntax","textArea","resourceCombobox","node","functionCombobox","operatorInput","textEditorValue","defaultProps","ExpressionFormula","event","target","value","props","undefined","setState","textEditorRef","createRef","state","generatedId","generate","getId","icon","handleTextEditorChange","Component","displayName"],"mappings":"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","sourcesContent":["/* Copyright (c) 2015-present, salesforce.com, inc. All rights reserved */\n/* Licensed under BSD 3-Clause - see LICENSE.txt or git.io/sfdc-license */\n\n// Implements the [Expression Formula design pattern](https://lightningdesignsystem.com/components/expression/) in React.\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport assign from 'lodash.assign';\nimport ContentEditable from 'react-contenteditable';\n\n// ### shortid\n// [npmjs.com/package/shortid](https://www.npmjs.com/package/shortid)\n// shortid is a short, non-sequential, url-friendly, unique id generator\nimport shortid from 'shortid';\n\nimport { EXPRESSION_FORMULA } from '../../utilities/constants';\n\nimport Button from '../button';\n\nconst propTypes = {\n\t/**\n\t *  **Assistive text for accessibility.**\n\t * * `help`: Assistive text for help icon\n\t */\n\tassistiveText: PropTypes.shape({\n\t\thelp: PropTypes.string,\n\t}),\n\t/**\n\t * HTML id for component.\n\t */\n\tid: PropTypes.string,\n\t/**\n\t * CSS classes to be added to the element with class `.slds-form-element`. Uses `classNames` [API](https://github.com/JedWatson/classnames).\n\t */\n\tclassName: PropTypes.oneOfType([\n\t\tPropTypes.array,\n\t\tPropTypes.object,\n\t\tPropTypes.string,\n\t]),\n\t/**\n\t * Callbacks for various expression formula events such as text editor change, check syntax etc\n\t */\n\tevents: PropTypes.shape({\n\t\tonChangeTextEditor: PropTypes.func,\n\t\tonClickHelp: PropTypes.func,\n\t\tonClickCheckSyntax: PropTypes.func,\n\t}),\n\t/**\n\t * **Text labels for internationalization**\n\t * This object is merged with the default props object on every render.\n\t * * `label`: Label for the Expression Formula group.Defaults to \"Formula\"\n\t * * `checkSyntax`: Label for the Check Syntax Button. Defaults to \"Check Syntax\"\n\t * * `textArea`: Label for the `triggerType` selector. Defaults to \"Take Action When\"\n\t */\n\tlabels: PropTypes.shape({\n\t\tlabel: PropTypes.string,\n\t\tcheckSyntax: PropTypes.string,\n\t\ttextArea: PropTypes.string,\n\t}),\n\t/**\n\t *  Accepts a single combobox component, to select resource in the expression formula editor\n\t */\n\tresourceCombobox: PropTypes.node,\n\t/**\n\t *  Accepts a single combobox component, to select function in the expression formula editor\n\t */\n\tfunctionCombobox: PropTypes.node,\n\t/**\n\t *  Accepts a single input component, to enter operator in the expression formula editor\n\t */\n\toperatorInput: PropTypes.node,\n\t/**\n\t *  Value for the text editor in expression formula editor\n\t */\n\ttextEditorValue: PropTypes.node,\n};\n\nconst defaultProps = {\n\tassistiveText: {\n\t\thelp: 'Help',\n\t},\n\tlabels: {\n\t\tlabel: 'Formula',\n\t\tcheckSyntax: 'Check Syntax',\n\t\ttextArea: 'Text Area',\n\t},\n};\n/**\n * Expression Formula Component\n */\nclass ExpressionFormula extends React.Component {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.textEditorRef = React.createRef();\n\t\tthis.state = {\n\t\t\ttextEditorValue: 'Compose formula...', // default is set here to preserve functionality if not controlled by props.textEditorValue\n\t\t};\n\t\tthis.generatedId = shortid.generate();\n\t}\n\n\t/**\n\t * Get the Expression Condition's HTML id. Generate a new one if no ID present.\n\t */\n\tgetId() {\n\t\treturn this.props.id || this.generatedId;\n\t}\n\n\thandleTextEditorChange = (event) => {\n\t\tconst textEditorValue = event.target.value;\n\n\t\tif (this.props.textEditorValue === undefined) {\n\t\t\tthis.setState({ textEditorValue });\n\t\t}\n\n\t\tif (this.props.events && this.props.events.onChangeTextEditor) {\n\t\t\tthis.props.events.onChangeTextEditor(event, { textEditorValue });\n\t\t}\n\t};\n\n\trender() {\n\t\tconst assistiveText = assign(\n\t\t\t{},\n\t\t\tdefaultProps.assistiveText,\n\t\t\tthis.props.assistiveText\n\t\t);\n\t\tconst labels = assign({}, defaultProps.labels, this.props.labels);\n\n\t\treturn (\n\t\t\t<React.Fragment>\n\t\t\t\t<div\n\t\t\t\t\tid={this.getId()}\n\t\t\t\t\tclassName={classNames(\n\t\t\t\t\t\t`slds-expression_formula__rte`,\n\t\t\t\t\t\tthis.props.className\n\t\t\t\t\t)}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"slds-form-element\">\n\t\t\t\t\t\t<span className=\"slds-form-element__label\">{labels.label}</span>\n\t\t\t\t\t\t<div className=\"slds-form-element__control\">\n\t\t\t\t\t\t\t<div className=\"slds-rich-text-editor slds-grid slds-grid_vertical slds-nowrap\">\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\trole=\"toolbar\"\n\t\t\t\t\t\t\t\t\tclassName=\"slds-rich-text-editor__toolbar slds-shrink-none\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div className=\"slds-rich-text-editor__col slds-rich-text-editor__col_grow\">\n\t\t\t\t\t\t\t\t\t\t{this.props.resourceCombobox}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"slds-rich-text-editor__col slds-rich-text-editor__col_grow\">\n\t\t\t\t\t\t\t\t\t\t{this.props.functionCombobox}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"slds-rich-text-editor__col slds-rich-text-editor__col_grow\">\n\t\t\t\t\t\t\t\t\t\t{this.props.operatorInput}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"slds-rich-text-editor__col\">\n\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\tassistiveText={{\n\t\t\t\t\t\t\t\t\t\t\t\ticon: assistiveText.help,\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"slds-button_icon-container\"\n\t\t\t\t\t\t\t\t\t\t\tid={`${this.getId()}-help-button`}\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"icon\"\n\t\t\t\t\t\t\t\t\t\t\ticonCategory=\"utility\"\n\t\t\t\t\t\t\t\t\t\t\ticonName=\"help\"\n\t\t\t\t\t\t\t\t\t\t\tonClick={this.props.events.onClickHelp}\n\t\t\t\t\t\t\t\t\t\t\ttitle={assistiveText.help}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"slds-rich-text-editor__textarea slds-grid\">\n\t\t\t\t\t\t\t\t\t<ContentEditable\n\t\t\t\t\t\t\t\t\t\tid={`${this.getId()}-content-editor`}\n\t\t\t\t\t\t\t\t\t\taria-label={this.props.labels.textArea}\n\t\t\t\t\t\t\t\t\t\tclassName=\"slds-rich-text-area__content slds-text-color_weak slds-grow\"\n\t\t\t\t\t\t\t\t\t\tinnerRef={this.textEditorRef}\n\t\t\t\t\t\t\t\t\t\thtml={\n\t\t\t\t\t\t\t\t\t\t\tthis.props.textEditorValue !== undefined\n\t\t\t\t\t\t\t\t\t\t\t\t? this.props.textEditorValue\n\t\t\t\t\t\t\t\t\t\t\t\t: this.state.textEditorValue\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tonChange={this.handleTextEditorChange}\n\t\t\t\t\t\t\t\t\t\tdisabled={false}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"slds-m-top_small\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\tid={`${this.getId()}-check-syntax-button`}\n\t\t\t\t\t\tvariant=\"neutral\"\n\t\t\t\t\t\tlabel={labels.checkSyntax}\n\t\t\t\t\t\tonClick={this.props.events.onClickCheckSyntax}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</React.Fragment>\n\t\t);\n\t}\n}\n\nExpressionFormula.displayName = EXPRESSION_FORMULA;\nExpressionFormula.propTypes = propTypes;\nExpressionFormula.defaultProps = defaultProps;\n\nexport default ExpressionFormula;\n"],"file":"formula.js"}