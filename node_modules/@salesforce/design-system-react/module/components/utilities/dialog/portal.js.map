{"version":3,"sources":["../../../../.tmp-es/components/utilities/dialog/portal.jsx"],"names":["Component","Children","PropTypes","ReactDOM","PortalSettingsContext","documentDefined","document","Portal","props","portalNode","state","isOpen","renderPortal","unmountPortal","only","children","element","renderTo","querySelector","context","querySelectorAll","body","parentParentNode","getPortalParentNode","createElement","renderTag","setAttribute","appendChild","portalNodeInstance","onMount","undefined","portal","unmountComponentAtNode","parentNode","removeChild","id","className","style","Object","keys","forEach","key","onUpdate","getChildren","setupPortalNode","portalMount","instance","reactElement","domContainerNode","updateCallback","updatePortal","unstable_renderSubtreeIntoContainer","onOpen","setState","displayName","propTypes","string","any","node","object","func","defaultProps","onUnmount","contextType"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;AAEA,SAASA,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,SAASC,qBAAT,QAAsC,uBAAtC;AAEA;AACA;AACA;;AAEA,IAAMC,eAAe,GAAG,OAAOC,QAAP,KAAoB,WAA5C;;IACMC,M;;;;;AACL,kBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AAClB,8BAAMA,KAAN;AACA,UAAKC,UAAL,GAAkB,IAAlB;AACA,UAAKC,KAAL,GAAa;AACZC,MAAAA,MAAM,EAAE;AADI,KAAb;AAHkB;AAMlB;;;;WAED,6BAAoB;AACnB,WAAKC,YAAL;AACA;;;WAED,8BAAqB;AACpB,WAAKA,YAAL;AACA;;;WAED,gCAAuB;AACtB,WAAKC,aAAL;AACA;;;WAED,uBAAc;AACb,aAAOZ,QAAQ,CAACa,IAAT,CAAc,KAAKN,KAAL,CAAWO,QAAzB,CAAP;AACA;;;WAED,+BAAsB;AACrB,UAAIC,OAAJ;;AACA,UAAI,OAAO,KAAKR,KAAL,CAAWS,QAAlB,KAA+B,QAAnC,EAA6C;AAC5CD,QAAAA,OAAO,GAAGV,QAAQ,CAACY,aAAT,CAAuB,KAAKV,KAAL,CAAWS,QAAlC,CAAV;AACA,OAFD,MAEO,IACN,KAAKE,OAAL,IACA,OAAO,KAAKA,OAAL,CAAaF,QAApB,KAAiC,QADjC,IAEAX,QAAQ,CAACc,gBAAT,CAA0B,KAAKD,OAAL,CAAaF,QAAvC,CAFA,IAGAX,QAAQ,CAACc,gBAAT,CAA0B,KAAKD,OAAL,CAAaF,QAAvC,EAAiD,CAAjD,CAJM,EAKL;AAAA,oCACWX,QAAQ,CAACc,gBAAT,CAA0B,KAAKD,OAAL,CAAaF,QAAvC,CADX;;AAAA;;AACAD,QAAAA,OADA;AAED,OAPM,MAOA;AACNA,QAAAA,OAAO,GAAG,KAAKR,KAAL,CAAWS,QAAX,IAAwBZ,eAAe,IAAIC,QAAQ,CAACe,IAA9D;AACA;;AACD,aAAOL,OAAP;AACA;;;WAED,2BAAkB;AACjB,UAAMM,gBAAgB,GAAG,KAAKC,mBAAL,EAAzB;AACA,WAAKd,UAAL,GAAkB,EAAlB;;AAEA,UAAIJ,eAAJ,EAAqB;AACpB,aAAKI,UAAL,GAAkBH,QAAQ,CAACkB,aAAT,CAAuB,KAAKhB,KAAL,CAAWiB,SAAlC,CAAlB;AACA,aAAKhB,UAAL,CAAgBiB,YAAhB,CACC,OADD,EAEC,0CAFD;AAIA,aAAKjB,UAAL,CAAgBiB,YAAhB,CAA6B,WAA7B,EAA0C,4BAA1C;AACAJ,QAAAA,gBAAgB,CAACK,WAAjB,CAA6B,KAAKlB,UAAlC;AACA,aAAKmB,kBAAL,GAA0B,KAAKpB,KAAL,CAAWqB,OAAX,GACvB,KAAKrB,KAAL,CAAWqB,OAAX,CAAmBC,SAAnB,EAA8B;AAAEC,UAAAA,MAAM,EAAE,KAAKtB;AAAf,SAA9B,CADuB,GAEvB,KAAKA,UAFR;AAGA;AACD;;;WAED,yBAAgB;AACf,UAAI,KAAKA,UAAT,EAAqB;AACpBN,QAAAA,QAAQ,CAAC6B,sBAAT,CAAgC,KAAKvB,UAArC;AACA,aAAKA,UAAL,CAAgBwB,UAAhB,CAA2BC,WAA3B,CAAuC,KAAKzB,UAA5C;AACA;;AACD,WAAKA,UAAL,GAAkB,IAAlB;AACA;;;WAED,wBAAe;AAAA;;AACd,UAAI,KAAKD,KAAL,CAAW2B,EAAf,EAAmB;AAClB,aAAK1B,UAAL,CAAgB0B,EAAhB,GAAqB,KAAK3B,KAAL,CAAW2B,EAAhC;AACA;;AAED,UAAI,KAAK3B,KAAL,CAAW4B,SAAf,EAA0B;AACzB,aAAK3B,UAAL,CAAgB2B,SAAhB,GAA4B,KAAK5B,KAAL,CAAW4B,SAAvC;AACA;;AAED,UAAI,KAAK5B,KAAL,CAAW6B,KAAf,EAAsB;AACrBC,QAAAA,MAAM,CAACC,IAAP,CAAY,KAAK/B,KAAL,CAAW6B,KAAvB,EAA8BG,OAA9B,CAAsC,UAACC,GAAD,EAAS;AAC9C,UAAA,MAAI,CAAChC,UAAL,CAAgB4B,KAAhB,CAAsBI,GAAtB,IAA6B,MAAI,CAACjC,KAAL,CAAW6B,KAAX,CAAiBI,GAAjB,CAA7B;AACA,SAFD;AAGA;;AAED,UAAI,KAAKjC,KAAL,CAAWkC,QAAf,EAAyB;AACxB,aAAKd,kBAAL,GAA0B,KAAKpB,KAAL,CAAWkC,QAAX,CAAoB,KAAKd,kBAAzB,CAA1B;AACA;AACD;;;WAED,wBAAe;AAAA;;AACd;AACA,UAAI,CAAC,KAAKe,WAAL,EAAD,IAAuB,CAACtC,eAA5B,EAA6C;AAC5C,aAAKQ,aAAL;AACA;AACA;;AAED,UAAI,CAAC,KAAKJ,UAAV,EAAsB;AACrB,aAAKmC,eAAL;AACA;;AAED,UAAI,KAAKpC,KAAL,CAAWqC,WAAf,EAA4B;AAC3B,aAAKrC,KAAL,CAAWqC,WAAX,CAAuB;AACtBC,UAAAA,QAAQ,EAAE,IADY;AAEtBC,UAAAA,YAAY,EAAE,KAAKJ,WAAL,EAFQ;AAGtBK,UAAAA,gBAAgB,EAAE,KAAKvC,UAHD;AAItBwC,UAAAA,cAAc,EAAE,0BAAM;AACrB,YAAA,MAAI,CAACC,YAAL,GADqB,CACA;;AACrB;AANqB,SAAvB;AAQA,OATD,MASO;AACN;AACA/C,QAAAA,QAAQ,CAACgD,mCAAT,CACC,IADD,EAEC,KAAKR,WAAL,EAFD,EAGC,KAAKlC,UAHN,EAIC,YAAM;AACL,UAAA,MAAI,CAACyC,YAAL,GADK,CACgB;;;AAErB,cAAI,MAAI,CAACxC,KAAL,CAAWC,MAAX,KAAsB,KAA1B,EAAiC;AAChC,gBAAI,MAAI,CAACH,KAAL,CAAW4C,MAAf,EAAuB;AACtB,cAAA,MAAI,CAAC5C,KAAL,CAAW4C,MAAX,CAAkBtB,SAAlB,EAA6B;AAAEC,gBAAAA,MAAM,EAAE,MAAI,CAACY,WAAL;AAAV,eAA7B;AACA;;AACD,YAAA,MAAI,CAACU,QAAL,CAAc;AAAE1C,cAAAA,MAAM,EAAE;AAAV,aAAd;AACA;AACD,SAbF;AAeA;AACD;;;WAED,kBAAS;AACR,aAAO,IAAP;AACA;;;;EAlImBX,S;;AAqIrBO,MAAM,CAAC+C,WAAP,GAAqB,QAArB;AAEA/C,MAAM,CAACgD,SAAP,GAAmB;AAClB;AACD;AACA;AACC9B,EAAAA,SAAS,EAAEvB,SAAS,CAACsD,MAJH;;AAKlB;AACD;AACA;AACCvC,EAAAA,QAAQ,EAAEf,SAAS,CAACuD,GARF;;AASlB;AACD;AACA;AACCtB,EAAAA,EAAE,EAAEjC,SAAS,CAACsD,MAZI;;AAalB;AACD;AACA;AACCzC,EAAAA,QAAQ,EAAEb,SAAS,CAACwD,IAhBF;;AAiBlB;AACD;AACA;AACCtB,EAAAA,SAAS,EAAElC,SAAS,CAACuD,GApBH;;AAqBlB;AACD;AACA;AACCpB,EAAAA,KAAK,EAAEnC,SAAS,CAACyD,MAxBC;;AAyBlB;AACD;AACA;AACC9B,EAAAA,OAAO,EAAE3B,SAAS,CAAC0D,IA5BD;;AA6BlB;AACD;AACA;AACCR,EAAAA,MAAM,EAAElD,SAAS,CAAC0D,IAhCA;;AAiClB;AACD;AACA;AACClB,EAAAA,QAAQ,EAAExC,SAAS,CAAC0D,IApCF;;AAqClB;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACCf,EAAAA,WAAW,EAAE3C,SAAS,CAAC0D;AArDL,CAAnB;AAwDArD,MAAM,CAACsD,YAAP,GAAsB;AACrBpC,EAAAA,SAAS,EAAE,MADU;AAErBR,EAAAA,QAAQ,EAAE,IAFW;AAGrBY,EAAAA,OAAO,EAAE;AAAA,WAAM,IAAN;AAAA,GAHY;AAIrBuB,EAAAA,MAAM,EAAE;AAAA,WAAM,IAAN;AAAA,GAJa;AAKrBV,EAAAA,QAAQ,EAAE;AAAA,WAAM,IAAN;AAAA,GALW;AAMrBoB,EAAAA,SAAS,EAAE;AAAA,WAAM,IAAN;AAAA;AANU,CAAtB;AAQAvD,MAAM,CAACwD,WAAP,GAAqB3D,qBAArB;AACA,eAAeG,MAAf","sourcesContent":["/* Copyright (c) 2015-present, salesforce.com, inc. All rights reserved */\n/* Licensed under BSD 3-Clause - see LICENSE.txt or git.io/sfdc-license */\n\nimport { Component, Children } from 'react';\nimport PropTypes from 'prop-types';\nimport ReactDOM from 'react-dom';\nimport { PortalSettingsContext } from '../../portal-settings';\n\n/*\n * This component mounts its children within a disconnected render tree (portal).\n */\n\nconst documentDefined = typeof document !== 'undefined';\nclass Portal extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.portalNode = null;\n\t\tthis.state = {\n\t\t\tisOpen: false,\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.renderPortal();\n\t}\n\n\tcomponentDidUpdate() {\n\t\tthis.renderPortal();\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.unmountPortal();\n\t}\n\n\tgetChildren() {\n\t\treturn Children.only(this.props.children);\n\t}\n\n\tgetPortalParentNode() {\n\t\tlet element;\n\t\tif (typeof this.props.renderTo === 'string') {\n\t\t\telement = document.querySelector(this.props.renderTo);\n\t\t} else if (\n\t\t\tthis.context &&\n\t\t\ttypeof this.context.renderTo === 'string' &&\n\t\t\tdocument.querySelectorAll(this.context.renderTo) &&\n\t\t\tdocument.querySelectorAll(this.context.renderTo)[0]\n\t\t) {\n\t\t\t[element] = document.querySelectorAll(this.context.renderTo);\n\t\t} else {\n\t\t\telement = this.props.renderTo || (documentDefined && document.body);\n\t\t}\n\t\treturn element;\n\t}\n\n\tsetupPortalNode() {\n\t\tconst parentParentNode = this.getPortalParentNode();\n\t\tthis.portalNode = {};\n\n\t\tif (documentDefined) {\n\t\t\tthis.portalNode = document.createElement(this.props.renderTag);\n\t\t\tthis.portalNode.setAttribute(\n\t\t\t\t'style',\n\t\t\t\t'display: block; height: 0px; width: 0px;'\n\t\t\t);\n\t\t\tthis.portalNode.setAttribute('className', 'design-system-react-portal');\n\t\t\tparentParentNode.appendChild(this.portalNode);\n\t\t\tthis.portalNodeInstance = this.props.onMount\n\t\t\t\t? this.props.onMount(undefined, { portal: this.portalNode })\n\t\t\t\t: this.portalNode;\n\t\t}\n\t}\n\n\tunmountPortal() {\n\t\tif (this.portalNode) {\n\t\t\tReactDOM.unmountComponentAtNode(this.portalNode);\n\t\t\tthis.portalNode.parentNode.removeChild(this.portalNode);\n\t\t}\n\t\tthis.portalNode = null;\n\t}\n\n\tupdatePortal() {\n\t\tif (this.props.id) {\n\t\t\tthis.portalNode.id = this.props.id;\n\t\t}\n\n\t\tif (this.props.className) {\n\t\t\tthis.portalNode.className = this.props.className;\n\t\t}\n\n\t\tif (this.props.style) {\n\t\t\tObject.keys(this.props.style).forEach((key) => {\n\t\t\t\tthis.portalNode.style[key] = this.props.style[key];\n\t\t\t});\n\t\t}\n\n\t\tif (this.props.onUpdate) {\n\t\t\tthis.portalNodeInstance = this.props.onUpdate(this.portalNodeInstance);\n\t\t}\n\t}\n\n\trenderPortal() {\n\t\t// if no portal contents, then unmount\n\t\tif (!this.getChildren() || !documentDefined) {\n\t\t\tthis.unmountPortal();\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.portalNode) {\n\t\t\tthis.setupPortalNode();\n\t\t}\n\n\t\tif (this.props.portalMount) {\n\t\t\tthis.props.portalMount({\n\t\t\t\tinstance: this,\n\t\t\t\treactElement: this.getChildren(),\n\t\t\t\tdomContainerNode: this.portalNode,\n\t\t\t\tupdateCallback: () => {\n\t\t\t\t\tthis.updatePortal(); // update after subtree renders\n\t\t\t\t},\n\t\t\t});\n\t\t} else {\n\t\t\t// actual render\n\t\t\tReactDOM.unstable_renderSubtreeIntoContainer(\n\t\t\t\tthis,\n\t\t\t\tthis.getChildren(),\n\t\t\t\tthis.portalNode,\n\t\t\t\t() => {\n\t\t\t\t\tthis.updatePortal(); // update after subtree renders\n\n\t\t\t\t\tif (this.state.isOpen === false) {\n\t\t\t\t\t\tif (this.props.onOpen) {\n\t\t\t\t\t\t\tthis.props.onOpen(undefined, { portal: this.getChildren() });\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.setState({ isOpen: true });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\trender() {\n\t\treturn null;\n\t}\n}\n\nPortal.displayName = 'Portal';\n\nPortal.propTypes = {\n\t/*\n\t * What tag to use for the portal, defaults to `div`.\n\t */\n\trenderTag: PropTypes.string,\n\t/*\n\t * What node the portal is rendered to, defaults to `document.body`.\n\t */\n\trenderTo: PropTypes.any,\n\t/*\n\t * React id prop.\n\t */\n\tid: PropTypes.string,\n\t/*\n\t * Accepts a _single_ element or component.\n\t */\n\tchildren: PropTypes.node,\n\t/*\n\t * ClassName added to .\n\t */\n\tclassName: PropTypes.any,\n\t/*\n\t * An object of styles that are applied to the portal.\n\t */\n\tstyle: PropTypes.object,\n\t/*\n\t * Triggers when Portal render tree mounts. Pass in an undefined event and `{ portal: [node] }``\n\t */\n\tonMount: PropTypes.func,\n\t/*\n\t * Triggers when the portal is mounted.\n\t */\n\tonOpen: PropTypes.func,\n\t/*\n\t * Triggers when Portal re-renders its tree.\n\t */\n\tonUpdate: PropTypes.func,\n\t/**\n\t * If a dialog is `positione=\"overflowBoundaryElement\"`, it will be rendered in a portal or separate render tree. This `portalMount` callback will be triggered instead of the the default `ReactDOM.unstable_renderSubtreeIntoContainer` and the function will mount the portal itself. Consider the following code that bypasses the internal mount and uses an Enzyme wrapper to mount the React root tree to the DOM.\n\t *\n\t * ```\n\t * <Popover\n\t *   isOpen\n\t *   portalMount={({ instance, reactElement, domContainerNode }) => {\n\t *     portalWrapper = Enzyme.mount(reactElement, { attachTo: domContainerNode });\n\t *   }}\n\t *   onOpen={() => {\n\t *     expect(portalWrapper.find(`#my-heading`)).to.exist;\n\t *     done();\n\t *   }}\n\t * />\n\t * ```\n\t */\n\tportalMount: PropTypes.func,\n};\n\nPortal.defaultProps = {\n\trenderTag: 'span',\n\trenderTo: null,\n\tonMount: () => null,\n\tonOpen: () => null,\n\tonUpdate: () => null,\n\tonUnmount: () => null,\n};\nPortal.contextType = PortalSettingsContext;\nexport default Portal;\n"],"file":"portal.js"}